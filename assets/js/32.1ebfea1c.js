(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{412:function(_,v,t){"use strict";t.r(v);var e=t(41),o=Object(e.a)({},(function(){var _=this,v=_.$createElement,t=_._self._c||v;return t("ContentSlotsDistributor",{attrs:{"slot-key":_.$parent.slotKey}},[t("h1",{attrs:{id:"配置语法"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置语法"}},[_._v("#")]),_._v(" 配置语法")]),_._v(" "),t("h2",{attrs:{id:"waf"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#waf"}},[_._v("#")]),_._v(" "),t("code",[_._v("waf")])]),_._v(" "),t("ul",[t("li",[_._v("配置语法: "),t("code",[_._v("waf [ on | off ];")])]),_._v(" "),t("li",[_._v("默认值："),t("code",[_._v("off")])]),_._v(" "),t("li",[_._v("配置段: server")])]),_._v(" "),t("p",[_._v("是否启用本模块。")]),_._v(" "),t("h2",{attrs:{id:"waf-rule-path"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#waf-rule-path"}},[_._v("#")]),_._v(" "),t("code",[_._v("waf_rule_path")])]),_._v(" "),t("ul",[t("li",[_._v("配置语法: "),t("code",[_._v("waf_rule_path dir;")])]),_._v(" "),t("li",[_._v("默认值：无")]),_._v(" "),t("li",[_._v("配置段: server")])]),_._v(" "),t("p",[_._v("规则文件所在目录，且必须以"),t("code",[_._v("/")]),_._v("结尾。")]),_._v(" "),t("h2",{attrs:{id:"waf-mult-mount"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#waf-mult-mount"}},[_._v("#")]),_._v(" "),t("code",[_._v("waf_mult_mount")])]),_._v(" "),t("ul",[t("li",[_._v("配置语法: "),t("code",[_._v("waf_mult_mount [ on | off ];")])]),_._v(" "),t("li",[_._v("默认值："),t("code",[_._v("off")])]),_._v(" "),t("li",[_._v("配置段: server")])]),_._v(" "),t("p",[_._v("进行多阶段检查，当"),t("code",[_._v("nginx.conf")]),_._v("存在地址重写的情况下（如"),t("code",[_._v("rewrite")]),_._v("配置）建议启用，反之建议关闭。")]),_._v(" "),t("p",[_._v("本配置用于兼容 "),t("a",{attrs:{href:"https://nginx.org/en/docs/http/ngx_http_rewrite_module.html",target:"_blank",rel:"noopener noreferrer"}},[_._v("ngx_http_rewrite_module"),t("OutboundLink")],1),_._v("\n模块，详见"),t("a",{attrs:{href:"/zh-cn/guide/compatibility#ngx_http_rewrite_module"}},[_._v("模块兼容性")]),_._v("。")]),_._v(" "),t("div",{staticClass:"custom-block warning"},[t("p",{staticClass:"custom-block-title"},[_._v("警告")]),_._v(" "),t("p",[_._v("并不保证此配置可以完全解决兼容性问题，建议启用后进行测试。")])]),_._v(" "),t("h2",{attrs:{id:"waf-mode"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#waf-mode"}},[_._v("#")]),_._v(" "),t("code",[_._v("waf_mode")])]),_._v(" "),t("ul",[t("li",[_._v("配置语法: "),t("code",[_._v("waf_mode mode_type ...;")])]),_._v(" "),t("li",[_._v("默认值: 无")]),_._v(" "),t("li",[_._v("配置段: server")])]),_._v(" "),t("p",[_._v("指定防火墙的工作模式，至少指定一个模式，最多指定八个模式。")]),_._v(" "),t("p",[t("code",[_._v("mode_type")]),_._v("具有下列取值（不区分大小写）:")]),_._v(" "),t("ul",[t("li",[_._v("GET: 当"),t("code",[_._v("Http.Method=GET")]),_._v("时启动检查。")]),_._v(" "),t("li",[_._v("HEAD: 当"),t("code",[_._v("Http.Method=HEAD")]),_._v("时启动检查。")]),_._v(" "),t("li",[_._v("POST: 当"),t("code",[_._v("Http.Method=POST")]),_._v("时启动检查。")]),_._v(" "),t("li",[_._v("PUT: 当"),t("code",[_._v("Http.Method=PUT")]),_._v("时启动检查。")]),_._v(" "),t("li",[_._v("DELETE: 当"),t("code",[_._v("Http.Method=DELETE")]),_._v("时启动检查。")]),_._v(" "),t("li",[_._v("MKCOL: 当"),t("code",[_._v("Http.Method=MKCOL")]),_._v("时启动检查。")]),_._v(" "),t("li",[_._v("COPY: 当"),t("code",[_._v("Http.Method=COPY")]),_._v("时启动检查。")]),_._v(" "),t("li",[_._v("MOVE: 当"),t("code",[_._v("Http.Method=MOVE")]),_._v("时启动检查。")]),_._v(" "),t("li",[_._v("OPTIONS: 当"),t("code",[_._v("Http.Method=OPTIONS")]),_._v("时启动检查。")]),_._v(" "),t("li",[_._v("PROPFIN: 当"),t("code",[_._v("Http.Method=PROPFIN")]),_._v("时启动检查。")]),_._v(" "),t("li",[_._v("PROPPATCH: 当"),t("code",[_._v("Http.Method=PROPPATCH")]),_._v("时启动检查。")]),_._v(" "),t("li",[_._v("LOCK: 当"),t("code",[_._v("Http.Method=LOCK")]),_._v("时启动检查。")]),_._v(" "),t("li",[_._v("UNLOCK: 当"),t("code",[_._v("Http.Method=UNLOCK")]),_._v("时启动检查。")]),_._v(" "),t("li",[_._v("PATCH: 当"),t("code",[_._v("Http.Method=PATCH")]),_._v("时启动检查。")]),_._v(" "),t("li",[_._v("TRAC: 当"),t("code",[_._v("Http.Method=TRAC")]),_._v("时启动检查。")]),_._v(" "),t("li",[_._v("IP: 启用 IP 地址的检查规则。")]),_._v(" "),t("li",[_._v("URL: 启用 url 的检查规则。")]),_._v(" "),t("li",[_._v("RBODY: 启用请求体的检查规则。")]),_._v(" "),t("li",[_._v("ARGS: 启用 args 的检查规则。")]),_._v(" "),t("li",[_._v("UA: 启用 user-agent 的检查规则。")]),_._v(" "),t("li",[_._v("COOKIE: 启用 cookie 的检查规则。")]),_._v(" "),t("li",[_._v("REFERER: 启用 referer 的检查规则。")]),_._v(" "),t("li",[_._v("CC: 启用 CC 防御。")]),_._v(" "),t("li",[_._v("STD: 等价于 "),t("code",[_._v("GET POST CC IP URL ARGS RBODY UA")]),_._v("。")]),_._v(" "),t("li",[_._v("FULL: 任何情况下都会启动检查并启用所有的检查规则。")])]),_._v(" "),t("blockquote",[t("p",[_._v("注意: "),t("code",[_._v("CC")]),_._v("是独立于其它模式的模式，其生效与否不受到其它模式的影响。典型情况如"),t("code",[_._v("URL")]),_._v("模式会受到"),t("code",[_._v("GET")]),_._v("模式的影响，因为如果不使用"),t("code",[_._v("GET")]),_._v("模式，那么在收到"),t("code",[_._v("GET")]),_._v("请求时就不会启动检查，自然也就不会检查 URL，但是"),t("code",[_._v("CC")]),_._v("模式不会受到类似的影响。")])]),_._v(" "),t("h2",{attrs:{id:"waf-cc-deny-limit"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#waf-cc-deny-limit"}},[_._v("#")]),_._v(" "),t("code",[_._v("waf_cc_deny_limit")])]),_._v(" "),t("ul",[t("li",[_._v("配置语法: "),t("code",[_._v("waf_cc_deny_limit rate duration;")])]),_._v(" "),t("li",[_._v("默认值：无")]),_._v(" "),t("li",[_._v("配置段: server")])]),_._v(" "),t("p",[_._v("包含两个参数，第一个参数"),t("code",[_._v("rate")]),_._v("表示每分钟的最多请求次数（大于零的整数），第二个参数"),t("code",[_._v("duration")]),_._v("表示超出第一个参数"),t("code",[_._v("rate")]),_._v("的限制后拉黑 IP 多少分钟（大于零的整数）。")])])}),[],!1,null,null,null);v.default=o.exports}}]);